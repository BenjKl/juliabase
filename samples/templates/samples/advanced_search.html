{# -*- indent-tabs-mode: nil -*- #}
{% extends "samples/base.html" %}
{% comment %}
This file is part of Chantal, the samples database.

Copyright (C) 2010 Forschungszentrum Jülich, Germany,
                   Marvin Goblet <m.goblet@fz-juelich.de>,
                   Torsten Bronger <t.bronger@fz-juelich.de>

You must not use, install, pass on, offer, sell, analyse, modify, or distribute
this software without explicit permission of the copyright holder.  If you have
received a copy of this software without the explicit permission of the
copyright holder, you must destroy it immediately and completely.
{% endcomment %}

{% load i18n %}
{% load samples_extras %}

{% block frame_content %}
<form method="get" action="">
  {{ search_root.as_p }}
  {% if model_tree %}
    {% display_search_tree model_tree %}
  {% endif %}
  <p class="submit-button" style="clear: both"><input type="submit" value="{% trans 'search' %}"/></p>
</form>

{% if search_performed %}
  <p>
    {% if too_many_results %}
      {% blocktrans %}
        Too many matches were found.  I show only {{ max_results }} of them.
      {% endblocktrans %}
    {% endif %}
  </p>
  <form method="post" action="">
    {% if results %}
      {% if something_to_add %}
        <p>{% trans 'Mark samples to add them to “My Samples”.' %}</p>
      {% endif %}
      <ul>
        {% for result, add_form in results %}
          <li><a href="{{ result.get_absolute_url }}">{{ result }}</a>
            {% if add_form %}
              {{ add_form.add_to_my_samples }}
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>{% trans 'Nothing found.' %}</p>
    {% endif %}

    <p class="submit-button" style="clear: both"><input type="submit" value="{% trans 'add samples' %}"/></p>
  </form>
{% else %}
  <p>{% trans 'No search was performed yet.' %}</p>
{% endif %}

{% if debug %}
<div id="debug">
  <h2>Queries</h2>
  <p>
    {{ sql_queries|length }} Quer{{ sql_queries|pluralize:"y,ies" }}
    {% ifnotequal sql_queries|length 0 %}
    (<span style="cursor: pointer;" onclick="var s=document.getElementById('debugQueryTable').style;s.display=s.display=='none'?'':'none';this.innerHTML=this.innerHTML=='Show'?'Hide':'Show';">Show</span>)
    {% endifnotequal %}
  </p>
  <table id="debugQueryTable" style="display: none;">
    <col width="1"></col>
    <col></col>
    <col width="1"></col>
    <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">SQL</th>
      <th scope="col">Time</th>
    </tr>
    </thead>
    <tbody>
    {% for query in sql_queries %}<tr class="{% cycle odd,even %}">
      <td>{{ forloop.counter }}</td>
      <td>{{ query.sql|escape }}</td>
      <td>{{ query.time }}</td>
    </tr>{% endfor %}
    </tbody>
  </table>
</div>
{% endif %}

{% endblock %}
