{# -*- indent-tabs-mode: nil -*- #}
{% extends "samples/base.html" %}
{% comment %}
This file is part of Chantal, the samples database.

Copyright (C) 2010 Forschungszentrum Jülich, Germany,
                   Marvin Goblet <m.goblet@fz-juelich.de>,
                   Torsten Bronger <t.bronger@fz-juelich.de>

You must not use, install, pass on, offer, sell, analyse, modify, or distribute
this software without explicit permission of the copyright holder.  If you have
received a copy of this software without the explicit permission of the
copyright holder, you must destroy it immediately and completely.
{% endcomment %}

{% load i18n %}
{% load samples_extras %}

{% block frame_content %}
  {% if topicless_samples or my_topics %}
    <div class="my-samples">
      <h2>{% trans 'My Samples' %}<a class="edit-icon" 
                             href="{% url samples.views.my_samples.edit username=user.username %}"
                             ><img src="{{ MEDIA_URL }}chantal/icons/pencil.png" alt="edit icon" title="{% trans 'edit' %}"
                                   width="16" height="16"/></a></h2>

      {% if topicless_samples %}
        <ul class="sample-list">
          {% for sample in topicless_samples %}
            <li><a href="{{ sample.get_absolute_url }}">{{ sample }}</a>{{ sample|sample_tags:user }}</li>
          {% endfor %}
        </ul>
      {% endif %}
      <div class="my-samples-topics">
        {% for topic in my_topics %}

          <h3><img src="{{ MEDIA_URL }}chantal/icons/group.png" alt="topic icon" style="margin-right: 0.5em"
                   width="16" height="16"/>{{ topic.topic_name }}</h3>

          {% if topic.samples %}
            <ul class="sample-list">
              {% for sample in topic.samples %}
                <li><a href="{{ sample.get_absolute_url }}">{{ sample }}</a>{{ sample|sample_tags:user }}</li>
              {% endfor %}
            </ul>
          {% endif %}

          <div class="my-samples-series">
            {% for series in topic.sample_series %}

              <h4><img src="{{ MEDIA_URL }}chantal/icons/chart_organisation.png" alt="sample series icon"
                       style="margin-right: 0.5em" width="16" height="16"
                       /><a href="{{ series.sample_series.get_absolute_url }}">{{ series.name }}</a></h4>

              {% if not series.is_complete %}
                <p>{% trans '(This series contains further samples not part of your “My Samples” list.)' %}</p>
              {% endif %}
              <ul class="sample-list">
                {% for sample in series.samples %}
                  <li><a href="{{ sample.get_absolute_url }}">{{ sample }}</a>{{ sample|sample_tags:user }}</li>
                {% endfor %}
              </ul>
            {% endfor %}
          </div>
        {% endfor %}
      </div>
    </div>
  {% endif %}

  <h2>{% trans 'Add things' %}</h2>

  {# FixMe: make translated strings lowercase and use |capfirst #}
  <ul style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/add.png")'>
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/ruby_add.png")'>
      <a href="{{ add_sample_url }}">{% trans 'Samples' %}</a></li>
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/chart_organisation_add.png")'>
      <a href="{% url samples.views.sample_series.new %}">{% trans 'Sample series' %}</a></li>
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/lightbulb_add.png")'>
      <a href="{% url add_result %}">{% trans 'Result' %}</a></li>
    {% for physical_process in physical_processes %}
      <li><a href="{{ physical_process.url }}">{{ physical_process.label|capfirst }}</a></li>
    {% endfor %}
  </ul>

  <h2>{% trans 'Search for things' %}</h2>
  <ul style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/find.png")'>
    <li><a href="{% url samples.views.sample.advanced_search %}">{% trans 'Advanced search' %}</a></li>
    <li><a href="{% url samples.views.sample.search %}">{% trans 'Samples by name' %}</a></li>
    <li><a href="{% url samples.views.main.deposition_search %}">{% trans 'Depositions by number' %}</a></li>
  </ul>

  {% if lab_notebooks %}
    <h2>{% trans 'Lab notebooks' %}</h2>

    <ul style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/book.png")'>
      {% for lab_notebook in lab_notebooks %}
        <li><a href="{{ lab_notebook.url }}">{{ lab_notebook.label|capfirst }}</a></li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if can_add_topic or can_edit_topics %}
    <h2>{% trans 'Edit topics' %}</h2>

    <ul>
      {% if can_add_topic %}
        <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/group_add.png")'>
          <a href="{% url samples.views.topic.add %}">{% trans 'Add new topic' %}</a></li>
      {% endif %}
      {% if can_edit_topics %}
        <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/group_gear.png")'>
          <a href="{% url samples.views.topic.list_ %}">{% trans 'Change topic memberships' %}</a></li>
      {% endif %}
    </ul>  
  {% endif %}  

  {% if can_add_external_operator or has_external_contacts %}
    <h2>{% trans 'External operators' %}</h2>

    <ul style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/user_gray.png")'>
      {% if can_add_external_operator %}
        <li><a href="{% url samples.views.external_operator.new %}">{% trans 'Add external operator' %}</a></li>
      {% endif %}  
      {% if has_external_contacts %}
        <li><a href="{% url samples.views.external_operator.list_ %}">{% trans 'Edit external operator' %}</a></li>
      {% endif %}  
    </ul>
  {% endif %}  

  <h2>{% trans 'Miscellaneous' %}</h2>
  <ul>
    {% if user.is_staff %}
      <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/user_suit.png")'><a href="admin/">{% trans 'Administration' %}</a></li>
    {% endif %}
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/user_edit.png")'>
      <a href="{% url samples.views.user_details.edit_preferences login_name=user.username %}"
         >{% trans 'Edit preferences' %}</a></li>
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/key.png")'>
      <a href="{% url samples.views.user_details.topics_and_permissions login_name=user.username %}"
         >{% trans 'My topics and permissions' %}</a></li>
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/webcam.png")'>
      <a href="{% url samples.views.permissions.list_ %}"
         >{% trans "Permissions to processes" %}</a></li>
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/shape_square_edit.png")'>
      <a href="{% url samples.views.my_layers.edit login_name=user.username %}">{% trans 'Edit “My Layers”' %}</a></li>
    {% if user.has_usable_password %}
      <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/lock_edit.png")'>
        <a href="{% url django.contrib.auth.views.password_change %}">{% trans 'Change password' %}</a></li>
    {% endif %}
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/feed.png")'>
      <a href="{% url samples.views.feed.show username=user.username user_hash=user_hash %}">{% trans 'Newsfeed' %}</a></li>
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/flag_blue.png")'>
      <a href="{% url samples.views.claim.list_ username=user.username %}">{% trans 'Sample claims' %}</a></li>
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/server_lightning.png")'>
    <!-- FixMe: The about and statistics pages must not be links from here but from another menue page. -->
      <a href="{% url chantal_ipv.views.statistics.about %}">{% trans 'About Chantal' %}</a></li>
    <li style='list-style-image: url("{{ MEDIA_URL }}chantal/icons/server_chart.png")'>
      <a href="{% url chantal_ipv.views.statistics.statistics %}">{% trans 'Server statistics' %}</a></li>
  </ul>
{% endblock %}
